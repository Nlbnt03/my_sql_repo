SELECT c.CITY, SUM(TOTALPRICE) TOTALSALE FROM ORDERS O
join ADDRESS a on a.ID = o.ADDRESSID
join CITIES c on c.ID = a.CITYID
GROUP BY c.CITY
ORDER BY 2 DESC